var Point=function(g,k){return{x:g,y:k}},isChrome=0<=navigator.userAgent.toLowerCase().indexOf("chrome"),rotate=function(g){return" rotate("+g+"deg)"},translate=function(g,k){return" translate3d("+g+"px,"+k+"px,0px)"};function label(g,k){var f=$(this).data();f.labelBox=$("<span style = 'position : absolute;'>"+g+"</span>");$(k).append(f.labelBox)}label.prototype.width=function(){return $(this).data().labelBox.width()};label.prototype.height=function(){return $(this).data().lableBox.height()};
var browserType,gradientColorA,gradientColorB,gradientColorAngle,backGroundImgURL,zoomButtonEnable=!0,thumbButtonEnable=!0,shareButtonEnable=!0,toolBarColor,buttonColor,originTotalPageCount,totalPageCount,pageWidth=320,pageHeight=460,leftShadowWidth=50,rightShadowWidth=50,zoomPageWidth,zoomPageHeight,flipTime=600,isRegister=!1,bookDescription,bookTitle,showFlipButton,isTouch="Touch"in window,loaderXML=function(){var g,k,f;function h(a,b){var c=$("<div style='position: absolute;'></div>"),d=pageEditor[a-
1][b].action,m,n=function(a){var b=a;"#"!=a.substr(0,1)&&"0x"!=a.substr(0,2)&&(b="#"+parseInt(a).toString(16));"0x"==a.substr(0,2)&&(b=a.replace("0x","#"));return b};void 0!=d.unshift&&(d=d[0]);m=d.triggerEventType;c.bind(g,function(g){var f=n(pageEditor[a-1][b].downColor);c.css({"background-color":f,opacity:pageEditor[a-1][b].downAlpha});m==PageEditor.TriggerEventType.MouseDown&&(d.actionType==PageEditor.ActionType.GOTO_PAGE?V(d.pageIndex):d.actionType==PageEditor.ActionType.OPEN_URL&&window.open(d.url,
d.linkTarget));g.stopPropagation()});c.bind("mouseover",function(){var g=n(pageEditor[a-1][b].overColor);c.css({"background-color":g,opacity:pageEditor[a-1][b].overAlpha});m==PageEditor.TriggerEventType.MouseOver&&(d.actionType==PageEditor.ActionType.GOTO_PAGE?V(d.pageIndex):d.actionType==PageEditor.ActionType.OPEN_URL&&window.open(d.url,d.linkTarget))});c.bind(isTouch?k:"mouseout",function(){var g=n(pageEditor[a-1][b].outColor);c.css({"background-color":g,opacity:pageEditor[a-1][b].outAlpha});m==
PageEditor.TriggerEventType.MouseOut&&(d.actionType==PageEditor.ActionType.GOTO_PAGE?V(d.pageIndex):d.actionType==PageEditor.ActionType.OPEN_URL&&window.open(d.url,d.linkTarget))});$.fn.extend(c,{onResize:function(d,m){var n=pageEditor[a-1][b].location;c.css({top:n.y*m+"px",left:n.x*d+"px",width:n.width*d+"px",height:n.height*m+"px"})}});return c}function e(){var a=$(this).data();a.previousPage=$("#singlePrePage");a.currentPage=$("#singleCurPage");a.nextPage=$("#singleNextPage");a.thickness=i(!1);
a.flippingPage={};a.flipToPage={};a.currentPageIndex=1;a.pageWidth=768;a.pageHeight=1024;a.maskWidth=1280;a.bookStatu=0;a.differPageNum=0;a.gotoPageIndex=0;a.bookMouseDown=!1;a.isLeft=!1;a.isTop=!1;a.cssObj={top:"0px",left:"0px",position:"absolute"};a.gotoPage=function(b){if(!(a.currentPageIndex==b||0!=a.bookStatu||1>b||b>originTotalPageCount)){a.setGotoPage(b);a.bookStatu=1;a.gotoPageIndex=b;var b=Point(0,0),c,d=Point(0,0);0<a.differPageNum?(b.x=a.pageWidth,b.y=0,d.x=-a.pageWidth,d.y=0,c="TOPRIGHT"):
(b.x=-a.pageWidth,b.y=0,d.x=a.pageWidth,d.y=0,c="TOPLEFT");a.flippingPage.beginFlip(c);a.timer(c,20,30,d,b,!0)}};a.setVisible=function(a){L.css("display",a?"block":"none")};a.changePage=function(){var b;0<a.differPageNum?(b=a.previousPage,a.previousPage=a.currentPage,a.currentPage=a.nextPage,a.nextPage=b):(b=a.nextPage,a.nextPage=a.currentPage,a.currentPage=a.previousPage,a.previousPage=b)};a.timer=function(b,c,d,m,n,g,f,h){void 0==f&&(f=!1);void 0==h&&(h=!1);Q=!0;R=!1;var e=(m.x-n.x)/c,i=(m.y-n.y)/
c,j=function(a,b){for(var d=b/2,c=(a-a/4)/d,m=Array(b),n=0;n<b;n++)m[n]=n<d?a-(d-n)*c:a+(n-d+1)*c;return m.reverse()},v=0,B=Point(0,0),k=j(e,c);speedArrayY=j(i,c);Point(0,0);var l=setInterval(function(){v++;B.x=n.x;B.y=n.y;for(var d=0;d<v;d++)B.x+=k[d],B.y+=speedArrayY[d];g&&(B.y=0.2*Math.sqrt(Math.pow(a.pageWidth,2)-Math.pow(B.x,2)));v==c&&(B=m);if(R){window.clearInterval(l);var d=0<=b.indexOf("LEFT"),e=0<=b.indexOf("TOP");a.differPageNum=d?-1:1;a.gotoPageIndex=d?a.currentPageIndex-1:a.currentPageIndex+
1;d=Point(d?a.pageWidth:-a.pageWidth,e?0:a.pageHeight);a.timer(b,6,30,d,B,!1,!0,!0)}else if(d=1,0>B.x&&(d=Math.min((B.x+a.pageWidth)/a.pageWidth+0.1,1),a.flippingPage.sideB.css("opacity",d)),a.flippingPage.flipToPoint(B,1==v),v>=c)window.clearInterval(l),Q=!1,g||h?(a.flippingPage.endFlip(),a.afterGotoPage()):f?!g&&!h&&(a.bookStatu=0,a.flippingPage.setSideAUp(!0),a.reset_z_index()):a.bookMouseDown=!0},d)};a.afterGotoPage=function(){a.currentPageIndex=a.gotoPageIndex;a.changePage();J(a.currentPageIndex,
!1);window.setTimeout(function(){a.bookStatu=0;ba&&W();a.fillNearPage(a.currentPageIndex);a.reset_z_index();a.flippingPage.resetPage()},30)};a.setGotoPage=function(b){a.differPageNum=b-a.currentPageIndex;a.currentPageIndex>b?(a.flippingPage=a.previousPage,a.flipToPage=a.previousPage,a.fillAnPage(a.flipToPage,b,a.currentPageIndex-1)):(a.flippingPage=a.currentPage,a.flipToPage=a.nextPage,a.fillAnPage(a.flipToPage,b,b),a.flipToPage.css({"z-index":4}),a.flippingPage.css({"z-index":5}))};a.fillAnPage=
function(a,c,d){a.sideA.fillImg(c,!1);a.sideB.fillImg(d,!0)};a.fillNearPage=function(b){1<b&&a.fillAnPage(a.previousPage,b-1,b-1);a.fillAnPage(a.currentPage,b,b);b<originTotalPageCount&&a.fillAnPage(a.nextPage,b+1,b+1)};a.reset_z_index=function(){a.previousPage.css("z-index",1);a.currentPage.css("z-index",3);a.nextPage.css("z-index",2)}}function i(a){var b=$("<div></div>"),c=$("<img src='style/thickness.png' style='position:absolute;' />");b.append(c);$.fn.extend(b,{visible:!0,onResize:function(a,
m){b.css({width:a,height:m});c.css({width:a,height:m})},setThicknessPosition:function(d,c){b.css({left:d,top:c,position:"absolute","z-index":a?8:9})},hideThickness:function(){b.css("display","none")},showThickness:function(){b.css("display","block")},setVisible:function(a){b.css({display:a?"block":"none"});b.visible=a}});a&&(c.css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)","-o-transform":"scaleX(-1)"}),b.css("display","none"),b.visible=!1);return b}var j=$("#bookContainer"),q,
o,S=$("#fbToolBar"),K=$("#currentPageIndexTextField"),x,y,r,z,s,A,t=1,D=1,G=0,H,C,F,E,M,X,u,la=getInt("topMargin",10),ma=getInt("leftMargin",10),xa=getInt("bottomMargin",10),ya=getInt("rightMargin",10),ca=!1,N=!1,da=!1,na=0,oa=0,O=0,Y=1E4,Z=1E4,R=!1,Q=!1,p=0,ba=!1,I=0;isTouch?(g="touchstart",f="touchmove",k="touchend"):(g="mousedown",f="mousemove",k="mouseup");if(compareov()){var T=function(a,b){var c;switch(b){case "normal":return c=getString("normalPath","files/page/")+a+".jpg";case "large":return c=
getString("largePath","files/large/")+a+".jpg";case "thumb":return c=getString("thumbPath","files/thumbnail/")+a+".jpg"}},J=function(a,b){if(a!=1&&a!=totalPageCount&&b)var c=Math.floor(a/2)*2,a=c+"-"+(c+1);c=totalPageCount;b||(c=originTotalPageCount);$("#fbCurrentPageIndex").text(a);K.val(a+"/"+c)},ga=function(){p==2?q.gotoPage(D+1):p==0?o.gotoPage(Math.floor(t/2+1)*2):$(w).data().gotoPage($(w).data().currentPageIndex+1)},ha=function(){p==2?q.gotoPage(D-1):p==0?o.gotoPage(Math.floor(t/2-1)*2+1):$(w).data().gotoPage($(w).data().currentPageIndex-
1)},V=function(a){p==2?q.gotoPage(a):p==0?o.gotoPage(a):$(w).data().gotoPage(a)};$("#btnRight").mouseup(ga);$("#btnLeft").mouseup(ha);$("#btnLast").mouseup(function(){p==2?q.gotoPage(originTotalPageCount):p==0?o.gotoPage(totalPageCount):$(w).data().gotoPage(originTotalPageCount)});$("#btnFirst").mouseup(function(){p==2?q.gotoPage(1):p==0?o.gotoPage(1):$(w).data().gotoPage(1)});$(window.document).bind("keydown",function(a){switch(a.keyCode){case 37:ha();break;case 39:ga()}});$("#btnZoom").mouseup(function(){if(showFlipButton){pa.setButtonPosition(p!=
0);qa.setButtonPosition(p!=0)}if(p==2){if(window.innerWidth<window.innerHeight){aa(1);p=1;J($(w).data().currentPageIndex);$(w).data().gotoPage(D)}else{aa(0);p=0;J(t,true);o.gotoPage(D)}$("#zoomImg").attr("src","style/ZoomIn.png");$("#btnZoom").attr("title","Zoom In")}else{D=p==0?t:$(w).data().currentPageIndex;C.changeImg(D);aa(2);p=2;$("#zoomImg").attr("src","style/ZoomOut.png");$("#btnZoom").attr("title","Zoom Out");J(D,false)}});$("#btnThumb").mouseup(function(){ca?l.hideThumb():l.showThumb();ca=
!ca});$("#btnShare").bind(k,function(){N?u.hideShareBar():u.showShareBar();N=!N;return false});$("#btnShare").bind(g,function(){return false});var ra=function(){x.css("z-index",5);y.css("z-index",4);z.css("z-index",3);r.css("z-index",2)},ea=function(a,b){a.fillSideA(b*2-1);a.fillSideB(b*2)},ia=function(a){var b=Math.floor(a/2);if(a>3){ea(r,b-1);r.setPageVisible(true);r.resetPage(true);r.setSideUp(false)}else r.setPageVisible(false);if(a>1){ea(x,b);x.setPageVisible(true);x.resetPage(true);x.setSideUp(false)}else x.setPageVisible(false);
if(Math.floor(a/2)*2+1<totalPageCount){ea(y,b+1);y.setPageVisible(true);y.resetPage(false);y.setSideUp(true)}else y.setPageVisible(false);if(Math.floor(a/2)*2+3<totalPageCount){ea(z,b+2);z.setPageVisible(true);z.resetPage(false);z.setSideUp(true)}else z.setPageVisible(false)},za=function(a){var b,c;if(t>a){b=Math.floor(a/2);c=Math.floor(t/2);s=x;if(c-b>1){A=z;A.resetPage(true);A.setSideUp(false);A.css("z-index",6);s.fillSideA(b*2+1);A.fillSideA(b*2-1);A.fillSideB(b*2)}else A=r;a!=1?A.setPageVisible(true):
A.setPageVisible(false)}else{b=Math.floor(a/2)+1;c=Math.floor(t/2)+1;s=y;if(b-c>1){A=r;A.resetPage(false);A.setSideUp(true);A.css("z-index",6);s.fillSideB(b*2-2);A.fillSideA(b*2-1);A.fillSideB(b*2)}else A=z;a!=totalPageCount?A.setPageVisible(true):A.setPageVisible(false)}I=b-c;return b!=c},U=function(a,b,c,d){d==void 0&&(d=false);return d?Point(b-L.offset().left,c-L.offset().top):Point(b-((a?0:pageWidth)+o.offset().left),c-o.offset().top)};$(window.document).bind(f,function(a){a=isTouch?a.originalEvent.touches:
[a];if(p==0){if(da){a=U(s.isLeft(),a[0].pageX,a[0].pageY);s.flipToPoint(a.x,a.y,false)}}else if(p==1&&$(w).data().bookMouseDown){flipPoint=U(true,a[0].pageX,a[0].pageY,true);$(w).data().flippingPage.flipToPoint(flipPoint)}});$(window.document).bind(k,function(a){var b=$(w).data(),a=isTouch?a.originalEvent.changedTouches:[a];if(p==0)if(da){var b=U(s.isLeft(),a[0].pageX,a[0].pageY),c,d=true;if(s.isLeft()&&b.x>=pageWidth||!s.isLeft()&&b.x<=0){d=false;G=s.isLeft()?Math.floor(t/2-1)*2+1:Math.floor(t/2+
1)*2;I=s.isLeft()?-1:1}c=Point(s.isLeft()?0:pageWidth,s.isTop()?0:pageHeight);a=Point(s.isLeft()?2*pageWidth:-pageWidth,s.isTop()?0:pageHeight);o.mouseToPoint(s.corner,b,d?c:a,true,!d);da=false}else Q&&(R=true);else if(p==1)if(b.bookMouseDown){c=U(true,a[0].pageX,a[0].pageY,true);d=true;if(b.isLeft&&c.x>=b.pageWidth/2||!b.isLeft&&c.x<b.pageWidth/2){d=false;b.gotoPageIndex=b.isLeft?b.currentPageIndex-1:b.currentPageIndex+1;b.differPageNum=b.isLeft?-1:1}a=d?Point(b.isLeft?-1:1,b.isTop?0:1):Point(b.isLeft?
1:-1,b.isTop?0:1);a=Point(a.x*b.pageWidth,a.y*b.pageHeight);b.timer("TOPRIGHT",6,30,a,c,false,true,!d);b.bookMouseDown=false}else Q&&(R=true)});$(window.document).bind(g,function(a){document.getElementById("currentPageIndexTextField").blur();var b=$(w).data(),a=isTouch?a.originalEvent.touches:[a];if(O==0&&p==0){na=a[0].pageX;oa=a[0].pageY;a=U(true,na,oa);if(a.x<0||a.x>2*pageWidth||a.y<0||a.y>pageHeight)return;var c,d;if(Math.pow(a.x,2)+Math.pow(a.y,2)<Y){c="TOPLEFT";d=Point(0,0);s=x;G=Math.floor(t/
2)*2-1;if(t==1)return}else if(Math.pow(2*pageWidth-a.x,2)+Math.pow(a.y,2)<Y){c="TOPRIGHT";a.x=a.x-pageWidth;d=Point(pageWidth,0);s=y;G=Math.floor(t/2+1)*2;if(t==totalPageCount)return}else if(Math.pow(a.x,2)+Math.pow(pageHeight-a.y,2)<Y){c="BOTTOMLEFT";d=Point(0,pageHeight);s=x;G=Math.floor(t/2)*2-1;if(t==1)return}else if(Math.pow(2*pageWidth-a.x,2)+Math.pow(pageHeight-a.y,2)<Y){c="BOTTOMRIGHT";a.x=a.x-pageWidth;d=Point(pageWidth,pageHeight);s=y;G=Math.floor(t/2+1)*2;if(t==totalPageCount)return}else return;
O=2;s.beginFlip(c);o.mouseToPoint(c,d,a,false)}else if(p==1&&b.bookStatu==0){a=U(true,a[0].pageX,a[0].pageY,true);if(a.x<0||a.x>b.pageWidth||a.y<0||a.y>b.pageHeight)return;if(Math.pow(a.x,2)+Math.pow(a.y,2)<Z){c="TOPLEFT";b.isLeft=true;b.isTop=true;d=Point(-b.pageWidth,0);b.flippingPage=b.previousPage;if(b.currentPageIndex==1)return}else if(Math.pow(a.x,2)+Math.pow(b.pageHeight-a.y,2)<Z){c="BOTTOMLEFT";b.isLeft=true;b.isTop=false;d=Point(-b.pageWidth,b.pageHeight);b.flippingPage=b.previousPage;if(b.currentPageIndex==
1)return}else if(Math.pow(b.pageWidth-a.x,2)+Math.pow(a.y,2)<Z){c="TOPRIGHT";b.isLeft=false;b.isTop=true;d=Point(b.pageWidth,0);b.flippingPage=b.currentPage;if(b.currentPageIndex==originTotalPageCount)return}else if(Math.pow(b.pageWidth-a.x,2)+Math.pow(b.pageHeight-a.y,2)<Z){c="BOTTOMRIGHT";b.isLeft=false;b.isTop=false;d=Point(b.pageWidth,b.pageHeight);b.flippingPage=b.currentPage;if(b.currentPageIndex==originTotalPageCount)return}else return;b.bookStatu=2;b.flippingPage.beginFlip(c);b.timer(c,6,
30,a,d,false,false)}else if(p==2)return;return false});var fa=function(a){var b,c,d,m=Point(0,0),n=$("<div class='pageMask'></div>"),g=$("<div class='sidePosition'></div>"),f=$("<div class='sidePosition'></div>"),h=sa(a,false),e=sa(a,true),i=$("<div class='backShadow'></div>"),j=$("<div class='frontShadow'></div>");n.append(g);n.append(f);f.append(h);g.append(e);a.append(i);a.append(n);$.fn.extend(a,{pageStatu:false,corner:"TOPRIGHT",pageIndex:1,resizePage:function(b,d){a.width(b);a.height(d);n.width(H);
n.height(H);g.css({width:b,height:d});f.css({width:b,height:d});i.css({width:b,height:d});j.css({width:b,height:d});h.resizeSide(b,d);e.resizeSide(b,d)},fillSideA:function(b){h.fillContent(b);a.pageIndex=b},fillSideB:function(a){e.fillContent(a)},flipPage:function(){e.flipSideA()},flipPageB:function(){h.flipSideB()},beginFlip:function(b){a.corner=b;if(a.isLeft()){h.append(j);a.flipStatu=true}else{e.append(j);a.flipStatu=false}G==1&&o.setLeftThicknessVisible(false);G==totalPageCount&&o.setRightThicknessVisible(false);
a.showShadow();n.css({width:H+"px",height:H+"px"})},flipToPoint:function(v,B,k){if(a.isCorner(v,B))a.resetPage(a.isLeft());else{v=ta(a.corner,v,B,pageWidth,pageHeight,H,j,i);b=v.Angle;d=v.Df;c=v.NomovePoint;m=v.Mv;if(k)if(a.isLeft()){h.hideGray();a.css({left:"0px"});g.css({right:"0px",left:"auto"});f.css({right:"0px",left:"auto"});if(a.isBottom()){g.css({top:"auto",bottom:"0px"});f.css({top:"auto",bottom:"0px"})}else{g.css({top:"0px",bottom:"auto"});f.css({top:"0px",bottom:"auto"})}a.setSideUp(true)}else{e.hideGray();
a.css({left:pageWidth+"px"});g.css({left:"0px",right:"auto"});f.css({left:"0px",right:"auto"});h.css({left:"0px",right:"auto","-webkit-transform":"translate(0px,0px)"});if(a.corner=="TOPRIGHT"){g.css({top:"0px",bottom:"auto"});f.css({top:"0px",bottom:"auto"})}else{g.css({top:"auto",bottom:"0px"});f.css({top:"auto",bottom:"0px"})}a.setSideUp(false)}switch(a.corner){case "TOPLEFT":a.rotateElement(n,"100% 0%",translate(-c.x+pageWidth-H+m.x,-c.y+m.y)+rotate(-b));a.rotateElement(g,"100% 0%",rotate(b)+
translate(c.x-m.x,c.y-m.y));a.rotateElement(f,"100% 0%",rotate(b)+translate(c.x+d.x-m.x,c.y+d.y-m.y));a.rotateElement(h,"100% 0%",translate(-pageWidth,0)+rotate(2*(90-b)));break;case "TOPRIGHT":a.rotateElement(n,"0% 0%",translate(c.x+m.x,-c.y+m.y)+rotate(b));a.rotateElement(f,"0% 0%",rotate(-b)+translate(-c.x-m.x,c.y-m.y));a.rotateElement(g,"0% 0%",rotate(-b)+translate(-c.x-m.x+d.x,c.y+d.y-m.y));a.rotateElement(e,"0% 0%",translate(0,0)+rotate(2*(b-90)));break;case "BOTTOMLEFT":a.rotateElement(n,"100% 100%",
translate(-c.x+pageWidth-H+m.x,c.y+pageHeight-H+m.y)+rotate(b));a.rotateElement(g,"100% 100%",rotate(-b)+translate(c.x-m.x,-c.y-m.y));a.rotateElement(f,"100% 100%",rotate(-b)+translate(c.x+d.x-m.x,-c.y-m.y+d.y));a.rotateElement(h,"100% 100%",translate(-pageWidth,-pageHeight)+rotate(2*(b-90)));break;case "BOTTOMRIGHT":a.rotateElement(n,"0% 100%",translate(c.x+m.x,c.y+pageHeight-H+m.y)+rotate(-b));a.rotateElement(f,"0% 100%",rotate(b)+translate(-c.x-m.x,-c.y-m.y));a.rotateElement(g,"0% 100%",rotate(b)+
translate(-c.x+d.x-m.x,-c.y+d.y-m.y));a.rotateElement(e,"0% 100%",translate(0,-pageHeight)+rotate(2*(90-b)))}}},endFlip:function(){a.hideShadow();a.pageStatu=a.isLeft()?false:true;h.showGray();e.showGray()},setSideUp:function(a){f.css("z-index",a?2:1);g.css("z-index",a?1:2)},getactualPoint:function(){},setElementPosition:function(){},rotateElement:function(a,b,d){a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":d,"-moz-transform":d,
"-ms-transform":d,"-o-transform":d})},translateElement:function(a,b,d){a.css({"-webkit-transform":"translate3d("+b+"px,"+d+"px,0px)","-moz-transform":"translate("+b+"px,"+d+"px)","-o-transform":"translate("+b+"px,"+d+"px)","-ms-transform":"translate("+b+"px,"+d+"px)"})},isTop:function(){return this.corner.indexOf("TOP")!=-1},isBottom:function(){return this.corner.indexOf("BOTTOM")!=-1},isLeft:function(){return this.corner.indexOf("LEFT")!=-1},isRight:function(){return this.corner.indexOf("RIGHT")!=
-1},isCorner:function(a,b){var d=0;this.isTop()&&b==0&&d++;this.isBottom()&&b==pageHeight&&d++;this.isLeft()&&a==0&&d++;this.isRight()&&a==pageWidth&&d++;return d==2},getPageStatu:function(){return pageStatu},setPageStatu:function(a){pageStatu=a},setPagePosition:function(b,d){a.css({top:"0px",left:d+"px"})},setSideAToUp:function(){},resetPage:function(b){a.css({left:b?"0px":pageWidth+"px"});n.css({top:"0px",left:"0px",bottom:"auto",right:"auto",width:pageWidth,height:pageHeight});a.rotateElement(n,
"0% 0%",translate(0,0)+rotate(0));f.css({top:"0px",left:"0px",bottom:"auto",right:"auto"});g.css({top:"0px",left:"0px",bottom:"auto",right:"auto"});a.rotateElement(f,"0% 0%",translate(0,0)+rotate(0));a.rotateElement(g,"0% 0%",translate(0,0)+rotate(0));a.rotateElement(h,"0% 0%",translate(0,0)+rotate(0));a.rotateElement(e,"0% 0%",translate(0,0)+rotate(0))},setPageVisible:function(b){b?a.css("display","block"):a.css("display","none")},flipToAnPoint:function(b,d,c){a.beginFlip(c);a.flipToPoint(b,d,false);
c=="TOPLEFT"||c=="BOTTOMLEFT"?a.setSideUp(true):a.setSideUp(false)},showShadow:function(){j.css({display:"block"});i.css({display:"block"})},hideShadow:function(){j.css({display:"none"});i.css({display:"none"})}})},ua=function(a,b,c,d,m,n){var g=function(){return a.indexOf("LEFT")>=0},f=function(){return a.indexOf("BOTTOM")>=0},h=Point(b,c),e,i,j;i=g()?d-b:b;j=f()?m-c:c;e=Math.sqrt(Math.pow(i,2)+Math.pow(j,2));i=Math.sqrt(Math.pow(i,2)+Math.pow(m-j,2));if(e>d&&i>n){if(e-d>i-n){h=g()?d-(d-b)*d/e:b*
d/e;e=f()?m-(m-c)*d/e:c*d/e}else{h=page.isLeft()?d-(d-b)*mastWidth/i:b*mastWidth/i;e=page.isTop()?m-(m-c)*mastWidth/i:c*mastWidth/i}h=Point(h,e);ua(a,h.x,h.y,d,m,n)}else{if(e>d){h=g()?d-(d-b)*d/e:b*d/e;e=f()?m-(m-c)*d/e:c*d/e;h=Point(h,e)}if(i>n){h=g()?d-(d-b)*mastWidth/i:b*mastWidth/i;e=a.indexOf("TOP")>=0?m-(m-c)*mastWidth/i:c*mastWidth/i;h=Point(h,e)}}if(a.indexOf("TOP")>=0&&h.y==0)h.y=m*0.0020;else if(f()&&h.y==m)h.y=m*0.998;return h},ta=function(a,b,c,d,m,n,g,h){var f,e;f=Point(b,c);f=ua(a,b,
c,d,m,n);c=f.x;e=f.y;f=function(){return a.indexOf("LEFT")>=0};b=function(){return a.indexOf("TOP")>=0};switch(a){case "TOPLEFT":actualPoint=Point(c,e);middlePoint=Point(d-actualPoint.x/2,e/2);endPoint=Point(d*2,0);break;case "TOPRIGHT":actualPoint=Point(d-c,e);middlePoint=Point(d-actualPoint.x/2,actualPoint.y/2);endPoint=Point(-d,0);break;case "BOTTOMLEFT":actualPoint=Point(c,m-e);middlePoint=Point(d-actualPoint.x/2,actualPoint.y/2);endPoint=Point(d*2,m);break;case "BOTTOMRIGHT":actualPoint=Point(d-
c,m-e);middlePoint=Point(d-actualPoint.x/2,actualPoint.y/2);endPoint=Point(-d,m)}var i=Point(0,0),j=Math.PI/2,v=Math.atan2(actualPoint.y,actualPoint.x);e=j-v;var c=e*180/Math.PI,k=e-Math.atan2(middlePoint.y,middlePoint.x);distance=Math.max(0,Math.sin(k)*Math.sqrt(Math.pow(middlePoint.x,2)+Math.pow(middlePoint.y,2)));noMovePoint=Point(distance*Math.sin(e),distance*Math.cos(e));var l;if(e>j){noMovePoint.x=noMovePoint.x+Math.abs(noMovePoint.y*Math.tan(v));noMovePoint.y=0;i=Math.PI-e;n=n-m/Math.sin(i)-
(noMovePoint.x-m/Math.tan(i))*Math.cos(i);i=Point(Math.round(n*Math.cos(i)),Math.round(n*Math.sin(i)));if(f())i.x=-i.x;if(b())i.y=-i.y}n=Math.sqrt(Math.pow(endPoint.x-actualPoint.x,2)+Math.pow(endPoint.y-actualPoint.y,2));j=Math.round(noMovePoint.y/Math.tan(e)+noMovePoint.x);f()&&(j=d-j);v=f()?j:d-j;k=v*Math.cos(e*2);l=v*Math.sin(e*2);j=Point(Math.round(j+(f()?-k:k)),Math.round(b()?l:m-l));l=v*Math.sin(e);v=Point(actualPoint.x/2/d*100,actualPoint.y/2/m*100);n=n<d?n/d:1;k=l>100?(l-100)/l:0;if(!b())v.y=
100-v.y;if(f())v.x=100-v.x;d=Point(l*Math.sin(e)/d*100,l*Math.cos(e)/m*100);if(!f())d.x=100-d.x;if(!b())d.y=100-d.y;g.css({"background-image":"-webkit-gradient(linear, "+(f()?100:0)+"% "+(b()?0:100)+"%, "+v.x+"% "+v.y+"%, color-stop("+k+",rgba(0,0,0,0)), color-stop("+((1-k)*0.8+k)+",rgba(0,0,0,"+0.2*n+")), to(rgba(255,255,255,"+0.2*n+")) )"});h.css({"background-image":"-webkit-gradient(linear, "+(f()?0:100)+"% "+(b()?0:100)+"%, "+d.x+"% "+d.y+"%,  color-stop(0.8,rgba(0,0,0,0)), color-stop(1, rgba(0,0,0,"+
0.2*n+")), to(rgba(0,0,0,0)) )"});return{Angle:c,Mv:i,Df:j,NomovePoint:noMovePoint}},sa=function(a,b){var c=$("<div class='side'></div>"),d=$("<div class='sideBackground'></div>"),e=$("<div class='sideContent'></div>"),f=$("<img/>"),g=$("<div class='kong' style='background-color:#888888;opacity:0.1'></div>"),i=-1;c.append(d);c.append(e);var j=getString("pageBackgroundColor","#f5f5f5");c.css({"background-color":j});var k;if(b){k=$("<div class='leftShadow'></div>");k.css("left",pageWidth-leftShadowWidth)}else k=
$("<div class='rightShadow'></div>");c.append(k);k.css("z-index",100);var l=$("<div style='position : absolute; z-index:101'></div>");c.append(l);var o=[];$.fn.extend(c,{fillContent:function(a){if(a!=i){i=a;e.empty();i>originTotalPageCount||f.load(T(i,"normal"),function(){f.attr("src",T(i,"normal"));e.append(f);e.append(g);c.initLink()})}},initLink:function(){l.empty();o=[];if(!(i<0||pageEditor.length<i||pageEditor[i-1][0]==null))for(var a=0;a<pageEditor[i-1].length;a++)if(pageEditor[i-1][a].annotype==
PageEditor.AnnoType.ANNO_LINK){var b=pageEditor[i-1][a].alpha,d=c.changeTo0x(pageEditor[i-1][a].downColor);c.changeTo0x(pageEditor[i-1][a].outColor);var e=pageEditor[i-1][a].location,f=h(i,a);o.push(f);l.append(f);f.css({top:e.y*pageHeight+"px",left:e.x*pageWidth+"px",width:e.width*pageWidth+"px",height:e.height*pageHeight+"px","background-color":d,opacity:b})}},changeTo0x:function(a){var b=a;a.substr(0,1)!="#"&&a.substr(0,2)!="0x"&&(b="#"+parseInt(a).toString(16));a.substr(0,2)=="0x"&&(b=a.replace("0x",
"#"));return b},showGray:function(){g.css({display:"block"})},hideGray:function(){g.css({display:"none"})},resizeSide:function(a,h){c.css("width",a+"px");c.css("height",h+"px");d.css("width",a+"px");d.css("height",h+"px");e.css("width",a+"px");e.css("height",h+"px");k.css("height",h);b&&k.css("left",pageWidth-leftShadowWidth);f.width(pageWidth);f.height(pageHeight);g.css({width:a,height:h});l.css({width:a,height:h});for(var i=0;i<o.length;i++)o[i].onResize(a,h)},hideProgress:function(){},showProgress:function(){},
showShadow:function(){},hideShadow:function(){}});return c},L=$("#singleBook");e.prototype.setSingleBookVisible=function(a){L.css({display:a?"block":"none"})};e.prototype.gotoAnPoint=function(a){$(this).data().gotoPage(a)};e.prototype.Create=function(){var a=$(this).data();this.initPage(a.previousPage);this.initPage(a.currentPage);this.initPage(a.nextPage);a.fillNearPage(1);L.append(a.thickness)};e.prototype.onResize=function(a,b){var c=$(this).data();c.maskWidth=Math.sqrt(Math.pow(a,2)+Math.pow(b,
2));L.css({width:a+"px",height:b+"px"});c.previousPage.onResize(a,b);c.currentPage.onResize(a,b);c.nextPage.onResize(a,b);c.pageWidth=a;c.pageHeight=b;$("#singleBookMask").css({width:window.innerWidth+"px",height:window.innerHeight-S.height()+"px"});c.thickness.onResize(15,b);c.thickness.setThicknessPosition(a-1,0);Z=Math.pow(Math.ceil(a/3),2)};e.prototype.setBookPosition=function(a,b){$("#singleBookMask").css({left:a+"px"});L.css({left:"0px",top:b+"px"})};e.prototype.initPage=function(a){var b=$(this).data();
a.mask=$("<div style='position:absolute;top:0px;left:0px;overflow:hidden;'></div>");a.sidePositionA=$("<div style='position:absolute;top:0px;left:0px;'></div>");a.sidePositionB=$("<div style='position:absolute;top:0px;left:0px;'></div>");a.sideA=this.initSide(a,true);a.sideB=this.initSide(a,false);a.shadowA=$("<div style='position:absolute;top:0px;left:0px;display: none;'></div>");a.shadowB=$("<div style='position:absolute;top:0px;left:0px; display: none;'></div>");a.corner="TOPRIGHT";a.realCorner=
"TOPRIGHT";L.append(a);a.append(a.shadowA);a.append(a.mask);a.mask.append(a.sidePositionB);a.mask.append(a.sidePositionA);a.sidePositionB.append(a.sideB);a.sidePositionA.append(a.sideA);a.sideB.append(a.shadowB);a.onResize=function(c,d){a.css({width:c+"px",height:d+"px"});a.mask.css({width:b.maskWidth+"px",height:b.maskWidth+"px"});a.shadowA.css({width:c+"px",height:d+"px"});a.shadowB.css({width:c+"px",height:d+"px"});a.sidePositionA.css({width:c+"px",height:d+"px"});a.sidePositionB.css({width:c+
"px",height:d+"px"});a.sideA.onResize(c,d);a.sideB.onResize(c,d)};a.beginFlip=function(b){a.realCorner=b;a.corner=b.indexOf("TOP")>=0?"TOPRIGHT":"BOTTOMRIGHT"};a.flipToPoint=function(c,d){d==void 0&&(d=false);if(a.isCorner(c.x,c.y)){a.resetPage();a.realCorner.indexOf("LEFT")>=0&&a.css("z-index",1)}else{var e=ta(a.corner,c.x,c.y,b.pageWidth,b.pageHeight,b.maskWidth,a.shadowB,a.shadowA);angle=e.Angle;df=e.Df;noMovePoint=e.NomovePoint;mv=e.Mv;if(d){a.setSideAUp(false);a.showShadow();b.flippingPage.css({"z-index":5});
if(a.corner=="TOPRIGHT"){a.sidePositionB.css({top:"0px",bottom:"auto"});a.sidePositionA.css({top:"0px",bottom:"auto"})}else{a.sidePositionB.css({top:"auto",bottom:"0px"});a.sidePositionA.css({top:"auto",bottom:"0px"})}}switch(a.corner){case "TOPRIGHT":a.rotateElement(a.mask,"0% 0%",translate(noMovePoint.x+mv.x,-noMovePoint.y+mv.y)+rotate(angle));a.rotateElement(a.sidePositionA,"0% 0%",rotate(-angle)+translate(-noMovePoint.x-mv.x,noMovePoint.y-mv.y));a.rotateElement(a.sidePositionB,"0% 0%",rotate(-angle)+
translate(-noMovePoint.x-mv.x+df.x,noMovePoint.y+df.y-mv.y));a.rotateElement(a.sideB,"0% 0%",translate(0,0)+rotate(2*(angle-90)));break;case "BOTTOMRIGHT":a.rotateElement(a.mask,"0% 100%",translate(noMovePoint.x+mv.x,noMovePoint.y+b.pageHeight-b.maskWidth+mv.y)+rotate(-angle));a.rotateElement(a.sidePositionA,"0% 100%",rotate(angle)+translate(-noMovePoint.x-mv.x,-noMovePoint.y-mv.y));a.rotateElement(a.sidePositionB,"0% 100%",rotate(angle)+translate(-noMovePoint.x+df.x-mv.x,-noMovePoint.y+df.y-mv.y));
a.rotateElement(a.sideB,"0% 100%",translate(0,-b.pageHeight)+rotate(2*(90-angle)))}}};a.rotateElement=function(a,b,e){a.css({"-webkit-transform-origin":b,"-moz-transform-origin":b,"-ms-transform-origin":b,"-o-transform-origin":b,"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,"-o-transform":e})};a.endFlip=function(){a.setSideAUp(true);a.hideShadow()};a.setSideAUp=function(b){a.sidePositionA.css({"z-index":b?2:1});a.sidePositionB.css({"z-index":b?1:2})};a.showShadow=function(){a.shadowA.css({display:"block"});
a.shadowB.css({display:"block"})};a.hideShadow=function(){a.shadowA.css({display:"none"});a.shadowB.css({display:"none"})};a.resetPage=function(){a.rotateElement(a.mask,"0% 0%",translate(0,0)+rotate(0));a.rotateElement(a.sideA,"0% 0%",translate(0,0)+rotate(0));a.rotateElement(a.sideB,"0% 0%",translate(0,0)+rotate(0));a.rotateElement(a.sidePositionA,"0% 0%",translate(0,0)+rotate(0));a.rotateElement(a.sidePositionB,"0% 0%",translate(0,0)+rotate(0));a.sidePositionA.css({top:"0px",bottom:"auto"});a.sidePositionB.css({top:"0px",
bottom:"auto"});a.sideB.css({opacity:1})};a.isCorner=function(c,d){var e=0;a.realCorner.indexOf("TOP")>=0&&d==0&&e++;a.realCorner.indexOf("BOTTOM")>=0&&d==b.pageHeight&&e++;a.realCorner.indexOf("LEFT")>=0&&c==-b.pageWidth&&e++;a.realCorner.indexOf("RIGHT")>=0&&c==b.pageWidth&&e++;return e>=2}};e.prototype.initSide=function(a,b){var c=$(this).data(),d=$("<div style='position:absolute;top:0px;left:0px;-webkit-box-shadow: 0 0 10px rgba(40, 0, 0, 0.5)'></div>"),e=$("<div style='position:absolute;top:0px;left:0px;background-color:#f5f0f5'></div>"),
f=$("<div style='position:absolute;top:0px;left:0px;'></div>"),g=$("<img />"),i=$("<div class='rightShadow' style='position:absolute;'></div>"),j=$("<div style='position : absolute; '></div>"),k=[];a.append(d);d.append(e);e.append(f);d.append(j);b&&e.append(i);d.imgIndex=0;d.onResize=function(a,b){d.css({width:a+"px",height:b+"px"});e.css({width:a+"px",height:b+"px"});f.css({width:a+"px",height:b+"px"});g.css({width:a+"px",height:b+"px"});i.css({height:b+"px"});j.css({width:a,height:b});for(var c=
0;c<k.length;c++)k[c].onResize(a,b)};d.fillImg=function(a,b){if(d.imgIndex!=a){d.imgIndex=a;f.empty();g.load(T(d.imgIndex,"normal"),function(){g.attr("src",T(d.imgIndex,"normal"));b&&g.css({"-webkit-transform":"scaleX(-1)","-moz-transform":"scaleX(-1)","-o-transform":"scaleX(-1)",filter:"flipH",opacity:0.2});f.append(g);d.initLink()})}};d.initLink=function(){j.empty();k=[];if(!(d.imgIndex<0||pageEditor.length<d.imgIndex||pageEditor[d.imgIndex-1][0]==null))for(var a=0;a<pageEditor[d.imgIndex-1].length;a++)if(pageEditor[d.imgIndex-
1][a].annotype==PageEditor.AnnoType.ANNO_LINK){var b=pageEditor[d.imgIndex-1][a].alpha,e=d.changeTo0x(pageEditor[d.imgIndex-1][a].downColor);d.changeTo0x(pageEditor[d.imgIndex-1][a].outColor);var f=pageEditor[d.imgIndex-1][a].location,g=h(d.imgIndex,a);k.push(g);j.append(g);g.css({top:f.y*c.pageHeight+"px",left:f.x*c.pageWidth+"px",width:f.width*c.pageWidth+"px",height:f.height*c.pageHeight+"px","background-color":e,opacity:b})}};d.changeTo0x=function(a){var b=a;a.substr(0,1)!="#"&&a.substr(0,2)!=
"0x"&&(b="#"+parseInt(a).toString(16));a.substr(0,2)=="0x"&&(b=a.replace("0x","#"));return b};return d};isTouch?window.onorientationchange=function(){W()}:$(window).resize(function(){W()});var W=function(){ba=false;if(p==0&&O==1||p==1&&$(w).data().bookStatu==1)ba=true;else{var a,b,c=window.innerWidth,d=window.innerHeight,e=bookConfig.largePageWidth,f=bookConfig.largePageHeight,g=c-ma-ya,h=d-la-xa-40;j.css("width",c);j.css("height",d);j.resizeBackGroundImg(c,d);a=2*e/f;if(g/h>a){b=h;a=a*b}else{a=g;
b=f*a/(2*e)}o.resizeBook(a/2,b);o.css("top",(h-b)/2+la);o.css("left",(g-a)/2+ma);ia(t);b=d-S.height();g=Point(0,0);if(c/b>e/f){g.x=e*b/f;g.y=b}else{g.x=c;g.y=c*f/e}w.onResize(g.x,g.y);w.setBookPosition((c-g.x)/2,(d-S.height()-g.y)/2);o.setThicknessPosition();if(p==0&&c<d){aa(1);p=1;$(w).data().gotoPage(t);J($(w).data().currentPageIndex,false)}if(p==1&&c>=d){aa(0);p=0;o.gotoPage($(w).data().currentPageIndex);J(t,true)}f=e=0;c>zoomPageWidth&&(e=(c-zoomPageWidth)/2);d>zoomPageHeight&&(f=(d-zoomPageHeight)/
2);E.css("left","0px");F.css("left","0px");C.css("z-index",6);q.zoomBookPosition(f,e);l.onResize();va();if(showFlipButton){pa.setButtonPosition(p!=0);qa.setButtonPosition(p!=0)}}},aa=function(a){switch(a){case 0:w.setSingleBookVisible(false);q.css("display","none");o.css("display","block");break;case 1:w.setSingleBookVisible(true);q.css("display","none");o.css("display","none");break;case 2:w.setSingleBookVisible(false);q.css("display","block");o.css("display","none")}},ja=function(a){var b=Aa();
a.append(b);$.fn.extend(a,{changeImg:function(a){b.changeContent(a)},resizeZoomPage:function(c,d){a.css("width",c);a.css("height",d);b.resizeZoomSide(c,d)}})},Aa=function(){var a=$("<div class='zoomSide'></div>"),b=$("<div class='kong'></div>"),c=$("<div class='kong'></div>"),d=$("<img/>");a.append(b);a.append(c);var e;$.fn.extend(a,{resizeZoomSide:function(e,f){a.css("width",e);a.css("height",f);b.css("width",e);b.css("height",f);c.css("width",e);c.css("height",f);d.css("width",e);d.css("height",
f);q.zoomWidth=e;q.zoomHeight=f},changeContent:function(a){if(e!=a){e=a;c.empty();d.load(function(){c.append(d)});d.attr("src",T(e,"large"))}}});return a},l,Ba=function(){var a=$("<div class='thumbItem'></div>");$("img src='style/progress.gif' style='position:absolute'/");var b=$("<img style='position:absolute' />");a.append(b);var c;$.fn.extend(a,{setThumbItemPosition:function(b,c){a.css("top",b);a.css("left",c)},onResize:function(b,c){a.css("width",b);a.css("height",c)},setImgSize:function(a,c,
e,f){b.css("width",a);b.css("height",c);b.css("top",(f-c)/2+"px");b.css("left",(e-a)/2+"px")},fillImg:function(d){if(d!=c){c=d;b.attr("src",T(c,"thumb"));d=$("<span id='thumbPageIndex' style='position:absolute;width:50px;padding:10px 5px;color:#999999 !important;' ><center>"+c+"</center></span>");a.append(d);d.css({top:"52px",left:"0px"})}},setImgPosition:function(a,c){b.css("top",a+"px");b.css("left",c+"px")}});a.bind(k,function(){if(!l.thumbDrag){V(c);return l.thumbMouseDown=false}});a.mouseover(function(){a.css("background-color",
"#888888")});a.mouseout(function(){a.css("background-color","transparent")});return a},P=function(a,b){var c;switch(a){case "email":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/forward/email/offer"+b+"' target='_blank'><img src='style/email.png' class='shareImg' />Email</a>");break;case "facebook":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/forward/facebook/offer"+b+"' target='_blank'><img src='style/facebook.png' class='shareImg' />Facebook</a>");
break;case "google":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/forward/igoogle/offer"+b+"' target='_blank'><img src='style/google.png' class='shareImg' />Google+</a>");break;case "mySpace":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/forward/myspace/offer"+b+"' target='_blank'><img src='style/myspace.png' class='shareImg' />MySpace</a>");break;case "netvibes":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/forward/netvibes/offer"+
b+"' target='_blank'><img src='style/netvibes.png' class='shareImg' />netvibes</a>");break;case "twitter":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/forward/twitter/offer"+b+"' target='_blank'><img src='style/twitter.png' class='shareImg' />Twitter</a>");break;case "digg":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/forward/digg/offer"+b+"' target='_blank'><img src='style/digg.png' class='shareImg' />Digg</a>");break;case "more":c=$("<a class='shareButton' href='http://api.addthis.com/oexchange/0.8/offer"+
b+"' target='_blank'><img src='style/more.png' class='shareImg' />More</a>")}c.mousedown(function(){c.css("background-color","#0000f0")});c.mouseup(function(){c.css("background-color","transparent");u.hideShareBar()});return c};j.mousedown(function(){if(N){u.hideShareBar();N=false}});var ka,wa=function(a){var b=$("<div style='position:absolute;width:50px;height:50px;z-index:100; -moz-border-radius: 5px;-webkit-border-radius: 5px;border-radius: 5px;'></div>"),c=$("<img style='position:absolute;'/>"),
d=50,e=50;$.fn.extend(b,{onResize:function(a,c){d=a;e=c;b.css({width:a+"px",height:c+"px"});setIconPosition()},setIconPosition:function(){c.css({height:e+"px",top:"0px",left:"7px"})},setButtonPosition:function(c){if(c)b.css({top:(window.innerHeight-e)/2+"px",left:a?"10px":window.innerWidth-10-d+"px"});else{c=a?o.offset().left-d-10:o.offset().left+pageWidth*2+10;c<10&&(c=10);c>window.innerWidth-10-d&&(c=window.innerWidth-10-d);b.css({top:(window.innerHeight-e)/2+"px",left:c+"px"})}},setButtonColor:function(){b.css({opacity:0.9})}});
$("body").append(b);b.append(c);c.attr({src:a?"style/previous_normal.png":"style/next_normal.png"});b.setButtonPosition(p!=0);b.setIconPosition();b.setButtonColor(buttonColor);b.bind(k,function(){a?ha():ga()});return b},va=function(){$("#toolBarBack").css({width:window.innerWidth+"px",height:"42px"});var a=$("#tfPageIndex").width();$("#btnLast").css({right:"3px"});$("#btnRight").css({right:"48px"});$("#tfPageIndex").css({right:"93px",top:"5px"});$("#btnLeft").css({right:90+a+3+"px"});$("#btnFirst").css({right:135+
a+3+"px"});a=180+a+3;if(zoomButtonEnable){$("#btnZoom").css({right:a+"px"});a=a+45}if(thumbButtonEnable){$("#btnThumb").css({right:a+"px"});a=a+45}shareButtonEnable&&$("#btnShare").css({right:a+"px"})};$("#fbToolBar").mousedown(function(){if(N){u.hideShareBar();N=false}});(function(){H=Math.sqrt(pageWidth*pageWidth+pageHeight*pageHeight);o=$("#flipBook");r=$("#previousPage");fa(r);x=$("#currentPageA");fa(x);y=$("#currentPageB");fa(y);z=$("#nextPage");fa(z);var a=true;Point(0,0);var b=i(true),c=i(false);
o.append(b);o.append(c);o.bind("mousedown",function(a){a.preventDefault()});o.bind("mousemove",function(a){a.preventDefault()});$.fn.extend(o,{resizeBook:function(a,e){pageWidth=a;pageHeight=e;H=Math.sqrt(pageWidth*pageWidth+pageHeight*pageHeight);o.css({width:a*2,height:e});r.resizePage(pageWidth,pageHeight);x.resizePage(pageWidth,pageHeight);y.resizePage(pageWidth,pageHeight);z.resizePage(pageWidth,pageHeight);o.setBookPosition(0,pageWidth);b.onResize(15,pageHeight);c.onResize(15,pageHeight);Y=
Math.pow(Math.ceil(pageWidth/3),2)},setVisible:function(a){a?o.css("display","block"):o.css("display","none")},setThicknessPosition:function(){b.setThicknessPosition(-14,0);c.setThicknessPosition(2*pageWidth-1,0)},setLeftThicknessVisible:function(a){b.setVisible(a)},setRightThicknessVisible:function(a){c.setVisible(a)},setBookPosition:function(a,b){r.setPagePosition(a,b);x.setPagePosition(a,b);y.setPagePosition(a,b);z.setPagePosition(a,b)},gotoPage:function(b){var c,e=0,f,g,h=0,i=0;if(!(b<1||Math.ceil(b/
2)*2>totalPageCount||O!=0)&&za(b)){b==totalPageCount&&z.setPageVisible(false);b==1&&r.setPageVisible(false);O=1;G=b;if(G>t){s.beginFlip("TOPRIGHT");g=0;c=-pageWidth;f=pageWidth;a=true}else{s.beginFlip("TOPLEFT");g=0;c=pageWidth*2;f=0;a=false}s.css("z-index",7);var h=f,j=function(a,b){for(var c=b/2,d=(a-a/4)/c,e=Array(b),f=0;f<b;f++)e[f]=f<c?a-(c-f)*d:a+(f-c+1)*d;return e.reverse()}(Math.ceil(c-f)*500/1E4,20);$.extend({flipTo:function(){e++;h=f;for(var b=0;b<e;b++)h=h+j[b];i=0.2*Math.sqrt(Math.pow(pageWidth,
2)-Math.pow(a?h:h-pageWidth,2));if(e==20){h=c;i=g}s.flipToPoint(h,i,e==1);if(e>=20){clearInterval(k);s.endFlip();o.afterGotoPage()}}});var k=setInterval("$.flipTo()",30)}},afterGotoPage:function(){t=G;o.changePage();J(t,true);window.setTimeout(function(){O=0;ba&&W();t!=1&&!b.visible&&b.setVisible(true);t!=totalPageCount&&!c.visible&&c.setVisible(true);ia(t);ra()},30)},changePage:function(){var a;if(I==1){a=z;z=r;r=x;x=y;y=a}else if(I==-1){a=r;r=z;z=y;y=x;x=a}else if(I==2||I==-2){a=r;r=y;y=a;a=x;x=
z;z=a}else if(I<-2){a=z;z=y;y=x;x=a}else if(I>2){a=x;x=y;y=r;r=a}},mouseToPoint:function(a,e,f,g,h){h==void 0&&(h=false);R=false;Q=true;var i=(f.x-e.x)/6,j=(f.y-e.y)/6,k,l;k=e.x;l=e.y;var p=function(a,b){for(var c=b/2,d=(a-a/4)/c,e=Array(b),f=0;f<b;f++)e[f]=f<c?a-(c-f)*d:a+(f-c+1)*d;return e.reverse()},q=p(i,6),w=p(j,6),u=0,r=Point(e.x,e.y);if(!g){x.css("z-index",a.indexOf("LEFT")!=-1?7:6);y.css("z-index",a.indexOf("LEFT")!=-1?6:7)}$.extend({flipTo:function(){u++;r.x=k;r.y=l;for(var e=0;e<u;e++){r.x=
r.x+q[e];r.y=r.y+w[e]}if(u==6){r.x=f.x;r.y=f.y}if(R){clearInterval(z);G=s.isLeft()?Math.floor(t/2-1)*2+1:Math.floor(t/2+1)*2;I=s.isLeft()?-1:1;e=Point(a.indexOf("LEFT")>=0?2*pageWidth:-pageWidth,a.indexOf("TOP")>=0?0:pageHeight);o.mouseToPoint(a,r,e,true,true)}else{s.flipToPoint(r.x,r.y,u==1);if(u>=6){clearInterval(z);Q=false;if(g)if(h){s.endFlip();o.afterGotoPage()}else{O=0;s.setSideUp(s.isLeft()?false:true);t!=1&&!b.visible&&b.setVisible(true);t!=totalPageCount&&!c.visible&&c.setVisible(true)}else da=
true}}}});var z=setInterval("$.flipTo()",30)}});ia(1)})();ra();(function(){var a=gradientColorA,b=gradientColorB,c=gradientColorAngle,d=$("<img />"),e=backGroundImgURL,f="0% 0%,100% 0%";switch(c){case 45:f="0% 0%,100% 100%";break;case 90:f="0% 0%,0% 100%";break;case 135:f="100% 0%,0% 100%";break;case 180:f="100% 0%,0% 0%";case 0:f="0% 0%,100% 0%"}browserType=="safari"?j.css("background-image","-webkit-gradient(linear,"+f+",from("+a+"),to("+b+"))"):browserType=="mozilla"&&j.css("background-image",
"-moz-linear-gradient(left "+c+"deg,"+a+","+b+")");if(e!=""&&e!="undefined"){var g=new Image;g.src=e;g.onload=function(){if(g.complete){d.attr("src",e);j.append(d);d.css("z-index",0);d.width(window.innerWidth);d.height(window.innerHeight)}}}$.fn.extend(j,{resizeBackGroundImg:function(){d.width(window.innerWidth);d.height(window.innerHeight)}})})();(function(){q=$("#zoomBook");C=$("#zoomCurPage");E=$("#zoomNextPage");F=$("#zoomPrePage");ja(E);ja(F);ja(C);q.css({"-webkit-box-shadow":"0px 0px 10px #333333",
"-moz-box-shadow":"0px 0px 10px #333333"});E.css("z-index",2);F.css("z-index",1);C.css("z-index",3);$.fn.extend(q,{zoomWidth:640,zoomHeight:920,onResize:function(a,b){q.css("width",a);q.css("height",b);F.resizeZoomPage(a,b);E.resizeZoomPage(a,b);C.resizeZoomPage(a,b)},gotoPage:function(a){if(!(D==a||a<1||a>totalPageCount)){I=a-D;var b,c;if(D>a){b=0;c=window.innerWidth+zoomPageWidth;M=C;X=F;X.changeImg(a);X.css("left","0px");E.css("z-index",1)}else{b=window.innerWidth+zoomPageWidth;c=0;M=E;M.changeImg(a);
X=C;F.css("z-index",1);M.changeImg(a)}X.css("z-index",2);M.css("z-index",3);M.css("left",b);M.animate({left:c},500,"linear",function(){q.changePage();q.endFlip(a)})}},setVisible:function(a){a?q.css("display","block"):q.css("display","none")},changePage:function(){var a;if(I>0){a=C;C=E;E=F}else{a=E;E=C;C=F}F=a},endFlip:function(a){D=a;a>1&&F.changeImg(a-1);C.changeImg(a);a<bookConfig.totalPageCount&&E.changeImg(a+1);C.css("z-index",3);E.css("z-index",2);F.css("z-index",1);J(D,false)},changeImg:function(){},
zoomBookPosition:function(a,b){q.css({top:a+"px",left:b+"px"})}});var a=false,b=0,c=0,d=0,e=0;q.bind(g,function(f){a=true;f=isTouch?f.originalEvent.touches:[f];b=f[0].pageX;c=f[0].pageY;d=parseInt(q.css("left").substring(0,q.css("left").length-2));e=parseInt(q.css("top").substring(0,q.css("top").length-2));return false});q.bind(k,function(){a=false});q.bind(f,function(f){if(p==2&&a){f=isTouch?f.originalEvent.touches:[f];q.css("left",f[0].pageX-b+d+"px");q.css("top",f[0].pageY-c+e+"px")}return false});
q.onResize(zoomPageWidth,zoomPageHeight)})();(function(){var a=$("<div class='thumbBG'></div>"),b=$("<img src='style/close.png' style='top:0px;right:1px;position:absolute;'>"),c=$("<div class='thumbBox'></div>"),d=$("<div class='scrollButton' style='display:none; left:0px;'></div>"),e=$("<div class='scrollButton' style='display:none;right:0px;'></div>"),h=$("<img src='style/previous_down.png' style='position:absolute;top:-5px;left:-5px;' />"),i=$("<img src='style/next_down.png' style='position:absolute;top:-5px;left:-5px;' />");
l=$("<div class='thumbBar' style='display:none;'></div>");j.append(l);l.append(a);l.append(b);a.append(c);a.append(d);a.append(e);d.append(h);e.append(i);d.bind(k,function(){if(!l.thumbDrag){var a=parseInt(c.css("left").substring(0,c.css("left").length-2));l.contentPos=a<-158?a+200:42;c.animate({left:l.contentPos},100,"linear")}});e.bind(k,function(){if(!l.thumbDrag){var a=parseInt(c.css("left").substring(0,c.css("left").length-2));if(a+c.width()>l.width()+158)l.contentPos=a-200;c.animate({left:l.contentPos},
100,"linear")}});$.fn.extend(l,{thumbDown:Point(0,0),thumbMove:Point(0,0),thumbEnd:0,thumbStartTime:0,thumbMoveTime:0,thumbEndTime:0,contentPos:0,thumbMouseDown:false,thumbDrag:false,dragEnable:false,showThumb:function(){l.css("display","block");l.animate({bottom:0},300,"linear")},hideThumb:function(){l.animate({bottom:-120},300,"linear")},thumbW_H:function(){var a={x:0,y:0};if(bookConfig.largePageWidth/bookConfig.largePageHeight>1){a.x=60;a.y=60*bookConfig.largePageHeight/bookConfig.largePageWidth}else{a.y=
60;a.x=60*bookConfig.largePageWidth/bookConfig.largePageHeight}return a},addAllItem:function(){for(var a=l.thumbW_H(),b=getInt("totalPageCount"),d=1;d<=b;d++){var e=Ba();c.append(e);e.css("top","12px");e.css("left",65*(d-1)+"px");e.fillImg(d);e.setImgSize(a.x,a.y,60,60)}c.css("width",65*b);if(c.width()>=window.innerWidth){c.css("left","42px");l.dragEnable=true;l.showSrcollButton()}else c.css("left",(l.width()-c.width())/2)},onResize:function(){if(c.width()>=window.innerWidth){if(!(parseInt(c.css("left").substring(0,
c.css("left").length-2))<0)){c.css("left","42px");l.dragEnable=true}l.showSrcollButton()}else{c.css("left",(l.width()-c.width())/2);l.hideSrcollButton();l.dragEnable=false}},showSrcollButton:function(){d.css("display","block");e.css("display","block")},hideSrcollButton:function(){d.css("display","none");e.css("display","none")}});b.bind(k,function(){l.hideThumb();ca=false});l.addAllItem();l.bind(g,function(a){l.thumbDrag=false;a=isTouch?a.originalEvent.touches:[a];l.thumbDown=Point(a[0].pageX,a[0].pageY);
l.thumbMouseDown=true;l.contentPos=c.offset().left;return false});l.bind(f,function(a){if(l.thumbMouseDown&&l.dragEnable){a=isTouch?a.originalEvent.touches:[a];l.thumbMove=Point(a[0].pageX,a[0].pageY);if(!l.thumbDrag&&Math.abs(l.thumbDown.x-l.thumbMove.x)>30)l.thumbDrag=true;a=l.contentPos-(l.thumbDown.x-l.thumbMove.x);a>42?c.css({left:"42px"}):a+c.width()<l.width()-42?c.css({left:l.width()-c.width()-42+"px"}):c.css({left:a+"px"});return false}});l.bind(k,function(){return l.thumbMouseDown=false})})();
(function(){u=$("<div class='shareBar' style='display:none;opacity:0'>");j.append(u);u.css("z-index",2002);u.css("bottom","38px");u.css("right","300px");var a=window.location.href,b=window.document.title,c=window.location.pathname,c=c.substring(0,c.lastIndexOf("/"))+"/files/thumb/1.jpg",d="?&url="+a+"&title="+b+"&description="+bookDescription+"&screenshot="+c,a=P("email",d),b=P("facebook",d),c=P("google",d),e=P("mySpace",d),f=P("twitter",d),g=P("digg",d),d=P("more",d);u.append(a);a.css({top:"8px",
left:"5px"});u.append(b);b.css({top:"38px",left:"5px"});u.append(c);c.css({top:"68px",left:"5px"});u.append(e);e.css({top:"98px",left:"5px"});u.append(f);f.css({top:"128px",left:"5px"});u.append(g);g.css({top:"158px",left:"px"});u.append(d);d.css({top:"188px",left:"5px"});$.fn.extend(u,{showShareBar:function(){u.css("display","block");u.animate({opacity:1},200,"linear")},hideShareBar:function(){u.animate({opacity:0},200,"linear",function(){u.css("display","none")})}})})();(function(){ka=$("#logoBar");
if(bookConfig.appLogoIcon!=void 0||bookConfig.appLogoIcon!=""){var a=bookConfig.appLogoLinkURL,b="_blank";if(a==void 0||a==""){a="javascript:Void();";b="_self"}var c=$("<a id='logoLink' href='"+a+"' target='"+b+"' style='width:35px;height:35px;'></a>"),d=$("<img />");d.load(function(){ka.append(c);c.append(d)});d.attr({src:bookConfig.appLogoIcon});d.css({position:"absolute",top:"0px",left:"0px",height:S.height()+"px"})}ka.css({top:"0px",left:"0px"})})();(function(){J(1,p==0);var a=[8,13,46,48,49,
50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105];K.css({padding:"3px"});K.bind("keydown",function(b){if(a.indexOf(b.keyCode)<0)return false;if(b.keyCode==13){b=K.val().replace(/\D/g,"");b=Math.min(Math.max(b,1),totalPageCount);V(b)}});K.bind("blur",function(){var a=t;if(p==1)a=$(w).data().currentPageIndex;p==2&&(a=D);J(a,p==0)});K.bind(k,function(){K.val("")})})();var w=new e;w.Create();if(showFlipButton)var pa=wa(!0),qa=wa(!1);W(void 0);va()}else alert("Purchase from www.flipbuilder.com to preview the book.")},
getString=function(g,k){return void 0==bookConfig[g]?k:bookConfig[g]},getInt=function(g,k){try{return NaN==parseInt(bookConfig[g])?k:parseInt(bookConfig[g])}catch(f){return k}},getBool=function(g,k){var f=["true","yes","show","enable"],h=["false","no","hide","disanble"],e=bookConfig[g].toLowerCase();return 0>f.indexOf(e)&&0>h.indexOf(e)?k:0<=f.indexOf(e)},PageEditor=function(){};PageEditor.AnnoType=function(){};PageEditor.AnnoType.ANNO_LINK="com.mobiano.flipbook.pageeditor.TAnnoLink";
PageEditor.TriggerEventType=function(){};PageEditor.TriggerEventType.MouseDown="mouseDown";PageEditor.TriggerEventType.MouseOver="mouseOver";PageEditor.TriggerEventType.MouseOut="mouseOut";PageEditor.ActionType=function(){};PageEditor.ActionType.GOTO_PAGE="com.mobiano.flipbook.pageeditor.TAnnoActionGotoPage";PageEditor.ActionType.OPEN_URL="com.mobiano.flipbook.pageeditor.TAnnoActionOpenURL";
jQuery(document).ready(function(){zoomButtonEnable=getBool("ZoomButtonVisible",!0);thumbButtonEnable=getBool("ThumbnailsButtonVisible",!0);shareButtonEnable=getBool("ShareButtonVisible",!0);originTotalPageCount=getInt("totalPageCount",2);totalPageCount=originTotalPageCount+(1==originTotalPageCount%2?1:0);zoomPageWidth=getInt("largePageWidth",640);zoomPageHeight=getInt("largePageHeight",920);pageWidth=zoomPageWidth;pageHeight=zoomPageHeight;gradientColorA=getString("bgBeginColor","#a93268");gradientColorB=
getString("bgEndColor","#588643");gradientColorAngle=getInt("bgMRotation",0);backGroundImgURL=getString("backGroundImgURL","");bookDescription=getString("bookDescription","This is a jQuery book.");bookTitle=getString("bookTitle","flipBook");showFlipButton=getBool("flipshortcutbutton",!0);window.document.title=bookTitle;$.browser.msie?browserType="msie":$.browser.mozilla?browserType="mozilla":$.browser.safari?browserType="safari":$.browser.opera&&(browserType="opera");loaderXML();zoomButtonEnable||
$("#btnZoom").css("display","none");thumbButtonEnable||$("#btnThumb").css("display","none");shareButtonEnable||$("#btnShare").css("display","none")});var hexcase=0,b64pad="",chrsz=8;function compareov(){var g=Date.parse(new Date);return orgt(g)===vldt(g)}function orgt(){return""}function vldt(g){return binl2hex(core_hx(str2binl(g),g.length*chrsz))}
function core_hx(g,k){g[k>>5]|=128<<k%32;g[(k+64>>>9<<4)+14]=k;for(var f=1732584193,h=-271733879,e=-1732584194,i=271733878,j=0;j<g.length;j+=16)var q=f,o=h,S=e,K=i,f=hx_ff(f,h,e,i,g[j+0],7,-680876936),i=hx_ff(i,f,h,e,g[j+1],12,-389564586),e=hx_ff(e,i,f,h,g[j+2],17,606105819),h=hx_ff(h,e,i,f,g[j+3],22,-1044525330),f=hx_ff(f,h,e,i,g[j+4],7,-176418897),i=hx_ff(i,f,h,e,g[j+5],12,1200080426),e=hx_ff(e,i,f,h,g[j+6],17,-1473231341),h=hx_ff(h,e,i,f,g[j+7],22,-45705983),f=hx_ff(f,h,e,i,g[j+8],7,1770035416),
i=hx_ff(i,f,h,e,g[j+9],12,-1958414417),e=hx_ff(e,i,f,h,g[j+10],17,-42063),h=hx_ff(h,e,i,f,g[j+11],22,-1990404162),f=hx_ff(f,h,e,i,g[j+12],7,1804603682),i=hx_ff(i,f,h,e,g[j+13],12,-40341101),e=hx_ff(e,i,f,h,g[j+14],17,-1502002290),h=hx_ff(h,e,i,f,g[j+15],22,1236535329),f=hx_gg(f,h,e,i,g[j+1],5,-165796510),i=hx_gg(i,f,h,e,g[j+6],9,-1069501632),e=hx_gg(e,i,f,h,g[j+11],14,643717713),h=hx_gg(h,e,i,f,g[j+0],20,-373897302),f=hx_gg(f,h,e,i,g[j+5],5,-701558691),i=hx_gg(i,f,h,e,g[j+10],9,38016083),e=hx_gg(e,
i,f,h,g[j+15],14,-660478335),h=hx_gg(h,e,i,f,g[j+4],20,-405537848),f=hx_gg(f,h,e,i,g[j+9],5,568446438),i=hx_gg(i,f,h,e,g[j+14],9,-1019803690),e=hx_gg(e,i,f,h,g[j+3],14,-187363961),h=hx_gg(h,e,i,f,g[j+8],20,1163531501),f=hx_gg(f,h,e,i,g[j+13],5,-1444681467),i=hx_gg(i,f,h,e,g[j+2],9,-51403784),e=hx_gg(e,i,f,h,g[j+7],14,1735328473),h=hx_gg(h,e,i,f,g[j+12],20,-1926607734),f=hx_hh(f,h,e,i,g[j+5],4,-378558),i=hx_hh(i,f,h,e,g[j+8],11,-2022574463),e=hx_hh(e,i,f,h,g[j+11],16,1839030562),h=hx_hh(h,e,i,f,g[j+
14],23,-35309556),f=hx_hh(f,h,e,i,g[j+1],4,-1530992060),i=hx_hh(i,f,h,e,g[j+4],11,1272893353),e=hx_hh(e,i,f,h,g[j+7],16,-155497632),h=hx_hh(h,e,i,f,g[j+10],23,-1094730640),f=hx_hh(f,h,e,i,g[j+13],4,681279174),i=hx_hh(i,f,h,e,g[j+0],11,-358537222),e=hx_hh(e,i,f,h,g[j+3],16,-722521979),h=hx_hh(h,e,i,f,g[j+6],23,76029189),f=hx_hh(f,h,e,i,g[j+9],4,-640364487),i=hx_hh(i,f,h,e,g[j+12],11,-421815835),e=hx_hh(e,i,f,h,g[j+15],16,530742520),h=hx_hh(h,e,i,f,g[j+2],23,-995338651),f=hx_ii(f,h,e,i,g[j+0],6,-198630844),
i=hx_ii(i,f,h,e,g[j+7],10,1126891415),e=hx_ii(e,i,f,h,g[j+14],15,-1416354905),h=hx_ii(h,e,i,f,g[j+5],21,-57434055),f=hx_ii(f,h,e,i,g[j+12],6,1700485571),i=hx_ii(i,f,h,e,g[j+3],10,-1894986606),e=hx_ii(e,i,f,h,g[j+10],15,-1051523),h=hx_ii(h,e,i,f,g[j+1],21,-2054922799),f=hx_ii(f,h,e,i,g[j+8],6,1873313359),i=hx_ii(i,f,h,e,g[j+15],10,-30611744),e=hx_ii(e,i,f,h,g[j+6],15,-1560198380),h=hx_ii(h,e,i,f,g[j+13],21,1309151649),f=hx_ii(f,h,e,i,g[j+4],6,-145523070),i=hx_ii(i,f,h,e,g[j+11],10,-1120210379),e=hx_ii(e,
i,f,h,g[j+2],15,718787259),h=hx_ii(h,e,i,f,g[j+9],21,-343485551),f=safe_add(f,q),h=safe_add(h,o),e=safe_add(e,S),i=safe_add(i,K);return[f,h,e,i]}function hx_cmn(g,k,f,h,e,i){return safe_add(bit_rol(safe_add(safe_add(k,g),safe_add(h,i)),e),f)}function hx_ff(g,k,f,h,e,i,j){return hx_cmn(k&f|~k&h,g,k,e,i,j)}function hx_gg(g,k,f,h,e,i,j){return hx_cmn(k&h|f&~h,g,k,e,i,j)}function hx_hh(g,k,f,h,e,i,j){return hx_cmn(k^f^h,g,k,e,i,j)}function hx_ii(g,k,f,h,e,i,j){return hx_cmn(f^(k|~h),g,k,e,i,j)}
function safe_add(g,k){var f=(g&65535)+(k&65535);return(g>>16)+(k>>16)+(f>>16)<<16|f&65535}function bit_rol(g,k){return g<<k|g>>>32-k}function str2binl(g){for(var k=[],f=(1<<chrsz)-1,h=0;h<g.length*chrsz;h+=chrsz)k[h>>5]|=(g.charCodeAt(h/chrsz)&f)<<h%32;return k}function binl2hex(g){for(var k=hexcase?"0123456789ABCDEF":"0123456789abcdef",f="",h=0;h<4*g.length;h++)f+=k.charAt(g[h>>2]>>8*(h%4)+4&15)+k.charAt(g[h>>2]>>8*(h%4)&15);return f};
